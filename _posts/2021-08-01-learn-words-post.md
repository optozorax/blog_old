---
layout: post
title:  "Программа для изучения английских слов"
tags: программирование программа язык
permalink: learn-words-post
description: "Как эта программа работает, почему я её сделал и в чём её отличия от других."
tagline: "Как эта программа работает, почему я её сделал и в чём её отличия от других."
image: /assets/learn-words-post/lw1.png
hide: true
---

<style type="text/css">
.container { 
  display: flex; 
  flex-direction: row;
  flex-wrap: wrap;
  justify-content: space-around;
  width: 90%;
  padding: 10px;
  margin: 5px;
}

.half-image {
  display: block;
  margin-left: auto;
  margin-right: auto;
  margin-top: 2px;
  border-radius: 5px;
}

@media only screen and (min-width:501px) {
  .half-image {
    max-width: 50%;
  }
}

@media only screen and (max-width: 500px) {
  .half-image {
    max-width: 100%;
  }
}

.third-image {
  display: block;
  margin-left: auto;
  margin-right: auto;
  margin-top: 2px;
  border-radius: 5px;
}

@media only screen and (min-width:851px) {
  .third-image {
    max-width: 31%;
  }
}

@media only screen and (min-width:501px) and (max-width: 850px) {
  .third-image {
    max-width: 48%;
  }
}

@media only screen and (max-width: 500px) {
  .third-image {
    max-width: 100%;
  }
}
</style>

# Введение

У меня сейчас такой уровень английского, что я могу понимать статью или фильм без перевода, но не знаю много слов, поэтому мелкие детали ускользают от меня. И постоянно везде слышу что в первую очередь нужно знать слова, а понимание грамматики само придёт. Поэтому передо мной встала проблема изучения слов.

Я попробовал разные приложения для телефона для изучения английского, и у них наблюдаются следующие **проблемы**:
1. Для проверки знания слова используется тест, где это слово находится рядом с 4 другими, разные значения слова не проверяются
2. Проверка слов начинается с самых простых
3. Нельзя сказать «я знаю это слово, убери»
4. Нельзя добавить своё слово
5. Нет статистики
6. Нельзя автоматически выбрать неизвестные мне слова из текста или видео

Поэтому я ещё много лет назад хотел написать свою программу для изучения слов, где бы решил эти проблемы по-своему. Тогда я знал только C++, и не умел программировать ничего сложнее базовых вещей на WinAPI. Я пытался тогда написать такую программу, но у меня только на самую простейшую часть интерфейса ушло неимоверное число усилий. В итоге этот проект был заброшен. Кому интересно, вот этот ужас: [1](https://github.com/optozorax/slovo-gonka), [2](https://github.com/optozorax/slovo_gonki2).

А сейчас я умею программировать очень сложные интерфейсы используя `ImGUI`, поэтому я решил попробовать снова написать эту программу, но только в этот раз в форме хакатона, замеряя время и стараясь сделать как можно быстрее.

И в результате у меня получилась программа по следующему адресу: [optozorax.github.io/learn_words](https://optozorax.github.io/learn_words/). 

А её исходники и бинари лежат здесь: [github.com/optozorax/learn_words](https://github.com/optozorax/learn_words).

# Способ проверки слова

Мне кажется что учить слова при помощи тестов, где нужный перевод уже написан и его можно найти методом исключения — гиблое дело. Перевод должен активно доставаться из памяти. Я знаю это, так как моя первая программа работала именно таким образом, и это было ужасно, я не запоминал ничего.

Поэтому я решил что слова надо учить печатью на клавиатуре. То есть тебе показывается слово, а ты должен ввести все его переводы вручную.

После добавления слова есть особый порядок когда его надо ввести снова:
* В первый день с подсказкой 2 раза, подсказка нужна чтобы запомнить слово.
* В первый день без подсказки 3 раза, далее всё будет без подсказки.
* Через день 5 раз
* Через неделю 5 раз
* Через 20 дней 5 раз
* После всего этого слово будет считаться выученным

В дни между этими слово не предлагается для ввода.

Ниже показано как вводится несколько разных переводов одного слова «mean».

<img class="half-image" src="/assets/learn-words-post/lw1.png">

Первый перевод «означать» мы уже выучили и нам его не нужно вводить, второй перевод «смысл» надо ввести с подсказкой, так как мы его только недавно добавили, а третий перевод «грубый» мы уже вводили с подсказками, а теперь надо активно доставать из памяти. То есть в этой программе учитывается что слово может иметь много разных смыслов.

По этим полям можно перемещаться при помощи Enter.

После ввода можно нажать кнопку «Next» и посмотреть насколько правильно мы ввели.

<img class="half-image" src="/assets/learn-words-post/lw2.png">

Таким образом я решаю 1 проблему из введения.

# Способ добавления слов

Во всех программах для изучения английских слов, обычно все их переводы и значения уже добавлены в программу, поэтому ты запускаешь и начинаешь работать. Я не мега-корпорация, и я делаю программу в первую очередь для себя, и хочу получить результат как можно быстрее, поэтому решил с этим не заморачиваться. Я выбрал путь ручного добавления.

Слово вместе со всеми его переводами можно добавить вручную. Это означает что ты сам должен знать какое слово тебе надо выучить и сам искать ему переводы.

<img class="half-image" src="/assets/learn-words-post/lw3.png">

Ещё здесь можно сказать что ты знаешь введённое слово (для этого переводы писать не нужно), или оно является мусорным (это для субтитров, будет объяснено далее).

Этим мы решаем 2, 3, 4 проблемы из введения.

## Добавление через текст и субтитры

Последний год я смотрю сериалы и фильмы в английской озвучке с русскими субтитрами, чтобы привыкать к английской речи и пытаться что-то запоминать. Недавно я переключился на английскую озвучку с английскими субтитрами и даже смог почти всё понимать. Поэтому для меня важна возможность экспортировать слова напрямую из субтитров.

Для этого есть специальное окошко для экспорта из субтитров формата `srt`.

<img class="half-image" src="/assets/learn-words-post/lw4.png">

Затем можно нажать кнопку «Use this text», и получить окошко, которое разобрало все эти слова и предлагает ввести информацию для каждого слова.

<img class="half-image" src="/assets/learn-words-post/lw5.png">

После добавления информации об одном слове, автоматически происходит переход к следующему слову.

И тут пригождается кнопка для «мусорных» слов. Это слова-артефакты парсинга субтитров, например `<i>`, `Mack:`, `O-o-o-okay`. Они записываются в программу только чтобы в будущем фильтроваться и не мешать.

Видим что из данных субтитров вышло 910 уникальных слов. Не волнуйтесь, так не будет каждый раз, это только в первые разы надо для кучи слов сказать что вы их знаете, а затем будет проще, все добавленные слова будут фильтроваться в следующих текстах и субтитрах. В итоге программа будет у вас спрашивать только то что вы действительно не знаете, или что она не знает.

Аналогично можно добавить слова из обычного текста. Можно перед прочтением статьи просто скопировать её в буфер обмена, вставить в программу и узнать все неизвестные слова.

Так же я никак не привожу слова к нормальной форме, все суффиксы с ним остаются, это вам придётся делать вручную, снова во имя простоты программирования.

Этим мы решаем 6 проблему из введения.

## Безумное решение большими компаниями

Кстати для решения этой проблемы всякие приложения по изучению английского делают просто безумную вещь: они имеют у себя размеченные видео, фильмы и сериалы, где можно прямо во время просмотра нажать на неизвестное слово, увидеть его перевод и добавить его в свой словарь. Это требует создание плееера в приложении, хранение видео на собственных серверах.

Ведь куда проще скачать субтитры видео, добавить их в программу и просто сразу автоматически отсеить известные слова, пройтись по ним два раза и смотреть. Субтитры ютуба [можно скачать через youtube-dl](https://superuser.com/questions/927523/how-to-download-only-subtitles-of-videos-using-youtube-dl), а английкие субтитры фильмов и сериалов можно просто найти бесплатно в интернете, вроде это даже не считается пиратством.

Честно, я хочу чтобы мир состоял именно из таких программ, как в этой статье, и как [youtube-dl](https://github.com/ytdl-org/youtube-dl). Мир должен быть модульным, и людям должно быть не лень прочитать одну статью чтобы понять как пользоваться программой, вместо того чтобы страдать с убер-упрощённым user-friendly лагучим featureless интерфейсом.

# Статистика

Программа для изучения этих слов подразумевает что в ней надо будет работать регулярно, что в ней будет тратиться какое-то значительное время. И раз происходят такие затраты, хотелось бы видеть какие именно у них результаты. Поэтому отсутствие нормальной статистики может дизморалить заниматься любым делом.

В первую очередь внизу есть панель, которая показывает статистику за текущий день. Такую панель я видел в программе VerseQ для обучения слепой печати, и мне это очень понравилось. Очень приятно видеть что сегодня я сделал столько-то работы за столько-то времени, так же это позволяет хорошо себя контролировать.

![](/assets/learn-words-post/lw6.png)

Есть полная статистика по словам:

<img class="third-image" src="/assets/learn-words-post/lw7.png">

Можно посмотреть статистику по дням: количество слов по категориям, время работы, количество попыток. Эти графики я пытался сделать в стиле [stackplot](https://matplotlib.org/stable/gallery/lines_bars_and_markers/stackplot_demo.html#sphx-glr-gallery-lines-bars-and-markers-stackplot-demo-py), но в используемой библиоетеке пока что отсутствует фича для закраски между двумя графиками.

<center>
<div class="container">
<img class="third-image" src="/assets/learn-words-post/lw8.png">
<img class="third-image" src="/assets/learn-words-post/lw9.png">
<img class="third-image" src="/assets/learn-words-post/lw10.png">
</div>
</center>

Кстати, так как время замеряется и потом отражается в статистике, то может произойти ситуация что ты отошёл, а программа продолжает замерять. И не хочется в статистике видеть такие мусорные данные. Поэтому после 15 секунд бездействия время перестаёт замеряться и весь экран осветляется с характерной иконкой паузы.

<img class="half-image" src="/assets/learn-words-post/lw12.png">

## GitHub-like

График активности в GitHub это просто гениальная вещь. У этой визуализации просто должен быть отдельный термин, потому что она должна быть просто в любом сервисе и программе, где что-то можно делать регулярно. Такая визуализация работы побуждает тебя работать лучше сейчас, потому что ты раньше хорошо работал, позволяет тебе окинуть взглядом всю твою работу, побуждает заниматься каждый день.

![](/assets/learn-words-post/github.png)

Поэтому я просто не мог не сделать свою программу без такой фичи.

![](/assets/learn-words-post/lw11.png)

И я сделал даже лучше: у меня можно крутить этот график, а ещё можно выбирать визуализацию трёх разных параметров, месяцы и года разделены линиями, а самое главное — неделя начинается с понедельника.

![](/assets/learn-words-post/lw13.gif)

Это окно всегда автоматически открывается при открытии программы, чтобы сразу при открытии было видно сколько ты работал и чтобы это придавало мотивации работать сейчас.

# Автоматическое переключение раскладки

У меня русские и английские переводы даются в случайном порядке. Поэтому может требоваться постоянно переключать раскладку. При вводе перевода программа точно знает на каком языке это должно быть, поэтому можно сделать чтобы язык переключался автоматически.

У меня это реализовано таким образом, что просто имеется хэш-мапа, которая для каждой английской буквы знает какая должная быть русская и наоборот. То есть когда вам надо набрать русское слово, вы просто печатаете его как будто сейчас включена русская раскладка, а программа автоматически сама всё исправит. Этот подход хорош тем, что не требует особых прав от программы по переключению раскладки. Например, в браузере через WASM переключить раскладку точно невозможно в целях безопасности. Но этот подход плох тем, что не будет работать для языков, где используются одинаковые символы с обеих сторон, например английский-немецкий. Если вдруг этой программой будет пользоваться больше чем 2 человека, я подумаю насчёт решения этой проблемы.

В настройках можно указать вашу раскладку, введя в одном поле все русские буквы, а в другом поле все английские в том же порядке. Символ новой строки игнорируется, а пробел может быть использован когда у вас невозможно набрать нужный символ. Этот подход хорош тем, что у вас могут быть самые упоротые раскладки клавиатуры типо Дворака и Диктора, а автопереключение раскладки всё-равно будет работать.

<img class="half-image" src="/assets/learn-words-post/lw14.png">

# Платформа

Программа может запускаться как в браузере, так и как нативное приложение. 

В браузере она запускается исключительно локально у вас, я не покупал никаких серверов, все вычисления происходят у вас. И я люблю такой подход, WASM это прекрасно. Получается это просто приложение, которое можно открыть в браузере без скачивания, и которое будет существовать независимо от меня.

А разница между браузерной и нативной программой только в том как будут храниться ваши данные. Для браузера они хранятся через [Web Storage API](https://developer.mozilla.org/en-US/docs/Web/API/Web_Storage_API), который сохраняется между закрытием вкладок или браузера, и вроде как даже может работать между разными браузерами для одного компьютера.

# Экспорт данных

Если для локального приложения все ваши данные и статистика лежат в одном файле `local.data` рядом с программой, то непонятно что делать с браузерными данными. А что если я хочу переустановить систему, как мне достать данные?

Специально для решения таких вопросов я сделал возможность экспортировать и импортировать всю статистику через буфер обмена. Пользователю просто передаётся эта информация и он может хранить её как ему вздумается.

Я считаю это очень важная возможность для вообще всех программ. Я не особо доверяю всем этим облачным программам, которые хранят мои вещи где-то там, и у меня нет возможности скачать все мои данные, или вставить их в другой аккаунт.

# Почти любой язык

Я называю это программой для изучения английских слов, но по факту она может использоваться для изучения любых слов на любых двух языках. Весь дизайн программы сделан язык-agnostic, будь то добавление слов или автопереключение раскладки.

Правда я не знаю как программа будет работать для языков с диактрикой, которая требует `.XCompose` или иероглифами. Ибо используемые библиотеки пока не настолько сильны. Так что можно сказать что в программе можно учить _\*почти_ любой язык.

# Заключение

Теперь я занимаюсь изучением слов через свою программу. Я обязательно опубликую свои результаты и мысли через несколько месяцев.

Я реализовал эту программу в полном соответствии со своим мировоззрением, видением обязательных фич и отношению к целесообразности переусложнений. И мне это нравится, потому что по моему мнению много программ делают неправильно, и я могу точно сказать что в них надо дополнить или как их сделать по-другому, чтобы они стали лучше. Кстати, на эту тему можно почитать мою страницу [Идеи](/ideas).

Я сделал эту программу со всеми этими фичами за 18 часов чистого времени, что невероятно быстро для программы с интерфейсом. Минимально рабочая версия была готова за 6 часов. За это спасибо концепции `ImGUI`, на которой невероятно просто и быстро можно делать интерфейсы, а ещё моему умению планировать программу и статической типизации Rust. Я полностью задокументировал процесс планирования этой программы, и каждого этапа её написания, так что скоро выйдет статья о том как она была написана.
